{% extends "base.html" %} {% block title %}Create new account{% endblock %} {% block body %}

<script language="javascript">
    function check() { //create new acct in firebase
        //document.write(document.getElementById("name").value);
        var ref = new Firebase("https://musichack16.firebaseio.com");

      
        ref.createUser({
         email    : document.getElementById("username").value,
         password : document.getElementById("password").value
       }, function(error, userData) {
      if (error) {
          switch (error.code) {
            case "EMAIL_TAKEN":
              window.location = "/username-exists"
              break;
            case "INVALID_EMAIL":
              window.location = "/invalid-email"
              break;
            default:
              document.write(error)
              console.log("Error creating user:", error);
          }
      } else {
          
          var users = ref.child("users");
          var thisUser = users.child(userData.uid);

          //var userid = userData.uid;
          thisUser.set({
              name: document.getElementById("name").value,
              username: document.getElementById("username").value,

              networks: {
                test_network: {
                  name: "West",
                  coins: 210,
                  is_admin: "true"
                }
              }
            }); //end set
        } //end else
        window.location = '/user?uid=' + userData.uid;
      });
 
      }
</script>

{% if error == "username exists" %}
<p style="color:red">Username already exists</p>
{% endif %}

{% if error == "invalid email" %}
<p style="color:red">Invalid email address</p>
{% endif %}

<div class="ui form segment">
  <p>Tell us about yourself</p>
    <div class="field">
      <label>Name</label>
      <input placeholder="Name" id="name" type="text">
    </div>
    <div class="field">
      <label>Username</label>
      <input placeholder="Username" id="username" type="text">
    </div>
    <div class="field">
      <label>Password</label>
      <input placeholder="Password" type="password" id="password">
    </div>
    <div class="field">
      <label>Re-type password</label>
      <input placeholder="Reenter your password" type="password" id="retype-password">
    </div>
  <div class="inline field">
  <div>
  <button onclick="check()"> Create account</button>
  <a href="/"><button type="button">Back</button></a>
  <div class="ui error message"></div>
</div>

{% endblock %}