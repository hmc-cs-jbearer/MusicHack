{
  "root": {

    "networks": {

      "testNet": {

        "users": {
          "admin": 1,
          "user": 1,
          "upvoter": 1,
          "downvoter": 1
        },

        "admins": {
          "admin": 1
        },

        "queue": {
          "front": "frontSong",
          "back": "backSong",

          "frontSong": {

            "data": {
              "album_name": "Crash",
              "artist_name": "Dave Matthews Band",
              "image_url": "www.foobar.com/foo",
              "name": "Two Step"
            },

            "requester": "admin",

            "coinsBeforeSong": 5,

            "upvoters": {
              "upvoter": 1
            },

            "downvoters": {
              "downvoter": 1
            },

            "next": "backSong"
          },

          "backSong": {

            "data": {
              "album_name": "The Head and the Heart",
              "artist_name": "The Head and the Heart",
              "image_url": "www.barfoo.com/bar",
              "name": "Down in the Valley"
            },

            "requester": "user",

            "coinsBeforeSong": 5
          }
        }
      }
    },

    "users": {

      "admin": {
        "name": "Joe Admin",
        "email": "jadmin@hmc.edu",
        "networks": {
          "testNet": {
            "coins": 5,
            "is_admin": "true"
          }
        }
      },

      "user": {
        "name": "Bob User",
        "email": "buser@hmc.edu",
        "networks": {
          "testNet": {
            "coins": 5
          }
        }
      },

      "upvoter": {
        "name": "Song Lover",
        "email": "uvoter@hmc.edu",
        "networks": {
          "testNet": {
            "coins": 5
          }
        }
      },

      "downvoter": {
        "name": "Song Hater",
        "email": "dvoter@hmc.edu",
        "networks": {
          "testNet": {
            "coins": 5
          }
        }
      }
    }
  },

  "users": {
    "user": {"uid": "user"},
    "admin": {"uid": "admin"},
    "upvoter": {"uid": "upvoter"},
    "downvoter": {"uid": "downvoter"},
    "newUser": {"uid": "newUser"},
    "anon": null
  },

  "tests": {

    // USER TESTS

    // Users can read their own data and noone elses
    "users/admin": {
      "canRead": ["admin"],
      "cannotRead": ["user", "anon"]
    },
    "users/user": {
      "canRead": ["user"],
      "cannotRead": ["admin", "anon"]
    },

    // A new user can add themselves to the database, as long as they have a
    // name and an email address
    "users/newUser": {
      "canWrite": [
        {"auth": "newUser", "data": {
          "name": "Newbie",
          "email": "newbie@hmc.edu"
        }}
      ],
      "cannotWrite": [
        {"auth": "newUser", "data": {"name": "Newbie"}},
        {"auth": "newUser", "data": {"email": "newbie@hmc.edu"}},
        {"auth": "user", "data": {
          "name": "Newbie",
          "email": "newbie@hmc.edu"
        }},
        {"auth": "admin", "data": {
          "name": "Newbie",
          "email": "newbie@hmc.edu"
        }}
      ]
    },

    // Users can change their own name as long as it remains a string
    "users/user/name": {
      "canWrite": [{"auth": "user", "data": "Any String"}],
      "cannotWrite": [
        {"auth": "user", "data": 5},
        {"auth": "admin", "data": "Someone elses name"},
        {"auth": "anon", "data": "Not even a user"}
      ]
    },

    /// \todo canWrite tests for email: must enforce uniqueness,
    /// or disallow all writes and let the server do it

    // Users cannot change their coin count; only a trusted server can
    "users/user/networks/testNet/coins": {
      "cannotWrite": [
        {"auth": "user", "data": 10},
        {"auth": "user", "data": "10"},
        {"auth": "admin", "data": 10},
        {"auth": "admin", "data": "10"},
        {"auth": "anon", "data": 10},
        {"auth": "anon", "data": "10"}
      ]
    },

    // Users can add themselves to a network iff they start out with 5 coins
    "users/user/networks/newNet": {
      "canWrite": [
        {"auth": "user", "data": {
          "coins": 5
        }}
      ],
      "cannotWrite": [
        {"auth": "user", "data": {
          "coins": 10
        }},
        {"auth": "user", "data": {}},
        {"auth": "admin", "data": {
          "coins": 5
        }},
        {"auth": "anon", "data": {
          "coins": 5
        }}
      ]
    },

    // Users can remove themselves but no one elsefrom networks
    "users/user/networks/testNet": {
      "canWrite": [{"auth": "user", "data": null}]
    },
    "users/admin/networks/testNet": {
      "cannotWrite": [{"auth": "user", "data": null}]
    },

    /// \todo Can users add themselves to newtorks?
    // ^ Depend on design decision resolving issues #7, #8

    // NETWORK TESTS

    // A user can read the data in their own network
    "networks/testNet": {
      "canRead": ["user", "admin"],
      "cannotRead": ["anon"]
    },

    // A user can remove themselves from a network, and admins can kick users
    // out of their networks
    "networks/testNet/users/user": {
      "canWrite": [
        {"auth": "user", "data": null},
        {"auth": "admin", "data": null}
      ]
    },
    "networks/testNet/users/admin": {
      "canWrite": [
        {"auth": "admin", "data": null}
      ],
      "cannotWrite": [
        {"auth": "user", "data": null}
      ]
    },

    /// \todo Test .write rules for network/admins. 
    /// Correct behavior will depend on resolution to issues #7, #8

    // A user can add or remove themselves but no one else to the upvote/downvote
    // list of the currently playing song only
    "networks/testNet/queue/frontSong/upvoters/user": {
      "canWrite": [
        {"auth": "user", "data": 1},
        {"auth": "user", "data": null}
      ],
      "cannotWrite": [
        {"auth": "admin", "data": 1},
        {"auth": "admin", "data": null},
        {"auth": "anon", "data": 1},
        {"auth": "anon", "data": null}
      ]
    },
    "networks/testNet/queue/frontSong/upvoters/admin": {
      "canWrite": [
        {"auth": "admin", "data": 1},
        {"auth": "admin", "data": null}
      ],
      "cannotWrite": [
        {"auth": "user", "data": 1},
        {"auth": "user", "data": null},
        {"auth": "anon", "data": 1},
        {"auth": "anon", "data": null}
      ]
    },
    "networks/testNet/queue/backSong/upvoters/user": {
      "cannotWrite": [
        {"auth": "user", "data": 1}
      ]
    },
    "networks/testNet/queue/backSong/upvoters/admin": {
      "cannotWrite": [
        {"auth": "admin", "data": 1}
      ]
    },
    "networks/testNet/queue/frontSong/downvoters/user": {
      "canWrite": [
        {"auth": "user", "data": 1},
        {"auth": "user", "data": null}
      ],
      "cannotWrite": [
        {"auth": "admin", "data": 1},
        {"auth": "admin", "data": null},
        {"auth": "anon", "data": 1},
        {"auth": "anon", "data": null}
      ]
    },
    "networks/testNet/queue/frontSong/downvoters/admin": {
      "canWrite": [
        {"auth": "admin", "data": 1},
        {"auth": "admin", "data": null}
      ],
      "cannotWrite": [
        {"auth": "user", "data": 1},
        {"auth": "user", "data": null},
        {"auth": "anon", "data": 1},
        {"auth": "anon", "data": null}
      ]
    },
    "networks/testNet/queue/backSong/downvoters/user": {
      "cannotWrite": [
        {"auth": "user", "data": 1}
      ]
    },
    "networks/testNet/queue/backSong/downvoters/admin": {
      "cannotWrite": [
        {"auth": "admin", "data": 1}
      ]
    },

    // A user cannot be in the upvote and downvote list at the same time
    "networks/testNet/queue/frontSong/upvoters/downvoter": {
      "cannotWrite": [{"auth": "downvoter", "data": 1}]
    },
    "networks/testNet/queue/frontSong/downvoters/upvoter": {
      "cannotWrite": [{"auth": "upvoter", "data": 1}]
    }

  }
}